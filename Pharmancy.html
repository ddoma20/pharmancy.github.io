<!DOCTYPE html>
<html lang="en" dir="ltr"> <!-- Start with LTR, JS will change lang and dir -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="appTitle">Pharmacy Distributor App</title>
    <style>
        :root {
            /* Default Theme (White) */
            --primary-color: #c00; --secondary-color: #6a0dad; --header-bg: #000000; --header-text: #ffffff; --background-color: #f4f4f4; --content-bg: #ffffff; --form-bg: #f0f0f0; --form-border: #e0e0e0; --text-color: #333; --text-muted: #555; --text-light: #888; --button-bg: #f0f0f0; --button-text: #555; --button-hover-bg: #e0e0e0; --input-bg: #f0f0f0; --input-border: #e0e0e0; --input-text: #333; --footer-bg: #ffffff; --footer-border: #eee; --logo-text: #000; --product-item-bg: #f9f9f9; --product-item-border: #eee; --checkmark-color: #4CAF50; --tab-inactive-color: #888; --tab-active-color: var(--primary-color); --tab-border-color: #eee; --radio-border: #ccc; --radio-checked-border: var(--primary-color); --radio-checked-dot: var(--primary-color); --header-curve-height: 30px; --header-curve-bg: var(--content-bg);
        }
        /* Red Theme */ [data-theme="red"] { --primary-color: #ff0000; --secondary-color: #cc0000; --header-bg: #ff0000; --header-text: #ffffff; --background-color: #ffebeb; --content-bg: #ffffff; --form-bg: #fff0f0; --form-border: #ffcccc; --text-color: #333; --text-muted: #555; --text-light: #888; --button-bg: #ffcccc; --button-text: #333; --button-hover-bg: #ffaaaa; --input-bg: #fff0f0; --input-border: #ffcccc; --input-text: #333; --footer-bg: #ffffff; --footer-border: #ffddd; --logo-text: #ff0000; --product-item-bg: #fff5f5; --product-item-border: #ffddd; --checkmark-color: #ff0000; --header-curve-bg: var(--content-bg); }
        /* Black & White Theme */ [data-theme="bw"] { --primary-color: #555; --secondary-color: #000; --header-bg: #000000; --header-text: #ffffff; --background-color: #e0e0e0; --content-bg: #ffffff; --form-bg: #f0f0f0; --form-border: #cccccc; --text-color: #000; --text-muted: #333; --text-light: #666; --button-bg: #e0e0e0; --button-text: #000; --button-hover-bg: #cccccc; --input-bg: #f0f0f0; --input-border: #cccccc; --input-text: #000; --footer-bg: #ffffff; --footer-border: #ddd; --logo-text: #000; --product-item-bg: #f5f5f5; --product-item-border: #ddd; --checkmark-color: #000; --radio-border: #999; --radio-checked-border: #000; --radio-checked-dot: #000; --header-curve-bg: var(--content-bg); }
        /* Black Theme */ [data-theme="black"] { --primary-color: #bbb; --secondary-color: #ccc; --header-bg: #1a1a1a; --header-text: #eee; --background-color: #121212; --content-bg: #1e1e1e; --form-bg: #2a2a2a; --form-border: #444; --text-color: #eee; --text-muted: #bbb; --text-light: #888; --button-bg: #333; --button-text: #eee; --button-hover-bg: #444; --input-bg: #2a2a2a; --input-border: #444; --input-text: #eee; --footer-bg: #1e1e1e; --footer-border: #333; --logo-text: #eee; --product-item-bg: #2a2a2a; --product-item-border: #444; --checkmark-color: #eee; --tab-inactive-color: #888; --tab-active-color: var(--primary-color); --tab-border-color: #333; --radio-border: #666; --radio-checked-border: var(--primary-color); --radio-checked-dot: var(--primary-color); --header-curve-bg: var(--content-bg); }
        /* Black & Red Theme */ [data-theme="black-red"] { --primary-color: #ff3333; --secondary-color: #ff6666; --header-bg: #1a0000; --header-text: #ffdddd; --background-color: #121212; --content-bg: #1e1e1e; --form-bg: #2a1a1a; --form-border: #552222; --text-color: #eee; --text-muted: #bbb; --text-light: #999; --button-bg: #4d0000; --button-text: #ffdddd; --button-hover-bg: #660000; --input-bg: #2a1a1a; --input-border: #552222; --input-text: #eee; --footer-bg: #1e1e1e; --footer-border: #440000; --logo-text: #ff3333; --product-item-bg: #2a1a1a; --product-item-border: #440000; --checkmark-color: #ff3333; --tab-inactive-color: #aaa; --tab-active-color: var(--primary-color); --tab-border-color: #440000; --radio-border: #884444; --radio-checked-border: var(--primary-color); --radio-checked-dot: var(--primary-color); --header-curve-bg: var(--content-bg); }
        /* Black & Orange Theme */ [data-theme="black-orange"] { --primary-color: #ff9900; --secondary-color: #ffad33; --header-bg: #1a1100; --header-text: #ffefcc; --background-color: #121212; --content-bg: #1e1e1e; --form-bg: #2a221a; --form-border: #553d11; --text-color: #eee; --text-muted: #bbb; --text-light: #999; --button-bg: #4d2c00; --button-text: #ffefcc; --button-hover-bg: #663b00; --input-bg: #2a221a; --input-border: #553d11; --input-text: #eee; --footer-bg: #1e1e1e; --footer-border: #442900; --logo-text: #ff9900; --product-item-bg: #2a221a; --product-item-border: #442900; --checkmark-color: #ff9900; --tab-inactive-color: #aaa; --tab-active-color: var(--primary-color); --tab-border-color: #442900; --radio-border: #886633; --radio-checked-border: var(--primary-color); --radio-checked-dot: var(--primary-color); --header-curve-bg: var(--content-bg); }
        /* Blue Theme */ [data-theme="blue"] { --primary-color: #007bff; --secondary-color: #0056b3; --header-bg: #004085; --header-text: #ffffff; --background-color: #e7f3ff; --content-bg: #ffffff; --form-bg: #f0f7ff; --form-border: #b8daff; --text-color: #333; --text-muted: #555; --text-light: #888; --button-bg: #cce5ff; --button-text: #004085; --button-hover-bg: #b8daff; --input-bg: #f0f7ff; --input-border: #b8daff; --input-text: #333; --footer-bg: #ffffff; --footer-border: #d6e9ff; --logo-text: #007bff; --product-item-bg: #f8f9fa; --product-item-border: #dee2e6; --checkmark-color: #28a745; --radio-border: #aaccff; --radio-checked-border: var(--primary-color); --radio-checked-dot: var(--primary-color); --header-curve-bg: var(--content-bg); }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { height: 100%; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--background-color); color: var(--text-color); transition: background-color 0.3s ease, color 0.3s ease; margin: 0; padding: 10px; min-height: 100%; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        .app-container { width: 100%; max-width: 1200px; min-height: calc(100vh - 20px); margin: 0 auto; background-color: var(--content-bg); border: 1px solid var(--form-border); border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; position: relative; padding-bottom: 60px; }
        .screen { display: none; flex-direction: column; width: 100%; flex-grow: 1; overflow-y: auto; }
        .screen.active { display: flex; }

        /* === CSS جديد ومُبسط للهيدر === */
        .header { background-color: var(--header-bg); color: var(--header-text); padding-top: 50px; padding-bottom: var(--header-curve-height); padding-left: 15px; padding-right: 15px; position: relative; margin-bottom: 15px; flex-shrink: 0; overflow: hidden; display: flex; align-items: center; min-height: 90px; }
        .header::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: var(--header-curve-height); background-color: var(--header-curve-bg); clip-path: ellipse(70% 100% at 50% 0%); z-index: 1; transition: background-color 0.3s ease; }
        .header .back-button { position: absolute; left: 15px; top: 50px; font-size: 1.8em; color: var(--header-text); text-decoration: none; line-height: 1; z-index: 3; }
        [dir="rtl"] .header .back-button { left: auto; right: 15px; transform: scaleX(-1); }
        .header-content-wrapper { flex-grow: 1; display: flex; align-items: center; justify-content: space-between; min-width: 0; position: relative; z-index: 2; padding-left: 35px; padding-right: 0; }
        .header > .header-content-wrapper:first-child { padding-left: 0; }
        [dir="rtl"] .header-content-wrapper { padding-left: 0; padding-right: 35px; }
        [dir="rtl"] .header > .header-content-wrapper:first-child { padding-right: 0; }
        .header h1 { margin: 0; font-size: 1.6em; font-weight: 500; flex-grow: 1; flex-shrink: 1; min-width: 0; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 5px; }
        .header-controls { display: flex; gap: 10px; align-items: center; flex-shrink: 0; }
        .header-controls select, .header-controls button { padding: 5px 8px; background-color: rgba(255, 255, 255, 0.1); color: var(--header-text); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 4px; font-size: 0.8em; cursor: pointer; max-width: 120px; }
        .header-controls select option { background-color: var(--header-bg); color: var(--header-text); }
        .header-controls button:hover { background-color: rgba(255, 255, 255, 0.2); }
        /* === نهاية CSS الجديد للهيدر === */

        .content { padding: 0 15px; flex-grow: 1; }
        .form-container { padding: 0 30px; flex-grow: 1; display: flex; flex-direction: column; max-width: 500px; width: 100%; margin: 0 auto; }
        .form-container label, .form-label { display: block; margin-bottom: 5px; color: var(--text-muted); font-size: 0.9em; padding-left: 5px; }
        .form-container input[type="email"], .form-container input[type="password"], .form-container input[type="text"], .form-container input[type="number"], .form-container select { width: 100%; padding: 15px; margin-bottom: 20px; border: 1px solid var(--input-border); border-radius: 25px; box-sizing: border-box; background-color: var(--input-bg); font-size: 1em; color: var(--input-text); }
        .form-container select option { background-color: var(--content-bg); color: var(--text-color); }
        .form-container select { appearance: none; background-image: none; background-repeat: no-repeat; background-position: right 15px center; background-size: .65em auto; padding-right: 40px; }
        .form-container .input-group { margin-bottom: 20px; }
        .link-text { text-align: left; margin-top: 5px; margin-bottom: 25px; font-size: 0.9em; }
        .link-text a { color: var(--secondary-color); text-decoration: none; font-weight: bold; }
        .next-button, .submit-button, .order-button { background-color: var(--button-bg); color: var(--button-text); border: none; padding: 12px 30px; border-radius: 20px; cursor: pointer; font-size: 1em; align-self: center; min-width: 100px; text-align: center; margin-top: auto; margin-bottom: 15px; transition: background-color 0.2s ease; }
        .next-button:hover, .submit-button:hover, .order-button:hover { background-color: var(--button-hover-bg); }
        .footer-logo { position: absolute; bottom: 0; left: 0; width: 100%; text-align: center; padding: 15px 0; background-color: var(--footer-bg); border-top: 1px solid var(--footer-border); z-index: 10; }
        .footer-logo span { font-weight: bold; font-size: 1.4em; color: var(--logo-text); }
        .footer-logo img { height: 30px; vertical-align: middle; }
        #welcome-screen { background-color: var(--content-bg); justify-content: center; align-items: center; flex-grow: 1; }
        #welcome-screen .logo-container { text-align: center; } #welcome-screen .logo { max-width: 60%; height: auto; filter: brightness(1.1); } #welcome-screen .welcome-text { margin-top: 10px; font-size: 1.2em; color: var(--text-color); } #welcome-screen .distributor-text { font-size: 0.8em; color: var(--text-muted); letter-spacing: 2px; text-transform: uppercase; margin-top: 5px; }
        .gender-options, .occupation-options { display: flex; gap: 20px; margin-bottom: 20px; align-items: center; padding-left: 5px; flex-wrap: wrap; } .radio-option label { display: inline-flex; align-items: center; cursor: pointer; color: var(--text-muted); } .radio-option input[type="radio"] { appearance: none; border: 2px solid var(--radio-border); width: 18px; height: 18px; border-radius: 50%; margin-right: 8px; position: relative; transition: border-color 0.2s; cursor: pointer; } .radio-option input[type="radio"]:checked { border-color: var(--radio-checked-border); } .radio-option input[type="radio"]:checked::after { content: ''; display: block; width: 10px; height: 10px; background-color: var(--radio-checked-dot); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); } .gender-box { border: 1px solid var(--form-border); background-color: var(--form-bg); padding: 10px 20px; border-radius: 20px; display: inline-block; }
        #home-screen .tabs { display: flex; justify-content: flex-start; gap: 20px; padding: 10px 15px; border-bottom: 1px solid var(--tab-border-color); margin-bottom: 15px; flex-shrink: 0; overflow-x: auto; } #home-screen .tab { cursor: pointer; padding-bottom: 5px; color: var(--tab-inactive-color); font-weight: 500; white-space: nowrap; } #home-screen .tab.active { color: var(--tab-active-color); border-bottom: 2px solid var(--tab-active-color); } #home-screen .content { padding: 0 15px; } #home-screen .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; } #home-screen .product-item { border: 1px solid var(--product-item-border); border-radius: 8px; padding: 10px; text-align: center; background-color: var(--product-item-bg); cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 120px; } #home-screen .product-item:hover { transform: translateY(-3px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); } #home-screen .product-item img { max-width: 90%; max-height: 90px; height: auto; display: block; object-fit: contain; }
        #payment-screen .content { display: flex; flex-direction: column; align-items: center; padding: 20px; flex-grow: 1; justify-content: center; } #payment-product-image { max-width: 70%; max-height: 30vh; height: auto; object-fit: contain; margin-bottom: 30px; } #payment-product-price { font-size: 1.5em; font-weight: bold; color: var(--text-color); margin-bottom: 40px; }
        #card-details-screen .content { padding: 20px 30px; flex-grow: 1; display: flex; flex-direction: column; } #card-details-screen form { flex-grow: 1; display: flex; flex-direction: column; max-width: 500px; width: 100%; margin: 0 auto; } #card-details-screen label:not(.radio-label) { display: block; margin-bottom: 5px; color: var(--text-muted); font-size: 0.9em; } #card-details-screen input[type="text"], #card-details-screen input[type="password"] { width: 100%; padding: 15px; margin-bottom: 20px; border: 1px solid var(--input-border); border-radius: 25px; box-sizing: border-box; background-color: var(--input-bg); font-size: 1em; color: var(--input-text); } #card-details-screen .payment-options { margin: 20px 0 30px 0; } #card-details-screen .payment-options .radio-option { margin-bottom: 10px;} #card-details-screen .payment-options label.radio-label { display: inline-flex; align-items: center; font-size: 0.9em; color: var(--text-color); } #card-details-screen .submit-button { display: block; margin: auto auto 20px auto; }
        #payment-done-screen .content { display: flex; flex-direction: column; align-items: center; justify-content: center; flex-grow: 1; text-align: center; } #payment-done-screen .checkmark { font-size: 5em; color: var(--checkmark-color); line-height: 1; margin-bottom: 10px; } #payment-done-screen .done-message { font-size: 2em; font-weight: bold; color: var(--text-muted); } #payment-done-screen .submit-button { margin: 20px auto; }

        /* RTL Styles Updated */
        [dir="rtl"] .header .back-button { left: auto; right: 15px; transform: scaleX(-1); }
        [dir="rtl"] .header-content-wrapper { padding-left: 0; padding-right: 35px; }
        [dir="rtl"] .header > .header-content-wrapper:first-child { padding-right: 0; }
        [dir="rtl"] .form-container label, [dir="rtl"] .form-label { padding-left: 0; padding-right: 5px; text-align: right; }
        [dir="rtl"] .link-text { text-align: right; }
        [dir="rtl"] .form-container select { background-position: left 15px center; padding-right: 15px; padding-left: 40px; }
        [dir="rtl"] .gender-options, [dir="rtl"] .occupation-options { padding-left: 0; padding-right: 5px; justify-content: flex-start; }
        [dir="rtl"] .radio-option input[type="radio"] { margin-right: 0; margin-left: 8px; }
        [dir="rtl"] #home-screen .tabs { justify-content: flex-start; }
        [dir="rtl"] .header-controls select { text-align-last: right; direction: rtl; }
        [dir="rtl"] .header-controls select option { direction: rtl; }

    </style>
</head>
<body>

    <div class="app-container"> <!-- Main App Wrapper -->

        <!-- Settings Controls Template -->
        <div id="header-controls-template" style="display: none;">
            <select id="theme-selector" title="Change Theme" onchange="setTheme(this.value)">
                <option value="default" data-translate-key="themeDefault">Theme: Default</option>
                <option value="red" data-translate-key="themeRed">Theme: Red</option>
                <option value="bw" data-translate-key="themeBW">Theme: B&W</option>
                <option value="black" data-translate-key="themeBlack">Theme: Black</option>
                <option value="black-red" data-translate-key="themeBlackRed">Theme: Black/Red</option>
                <option value="black-orange" data-translate-key="themeBlackOrange">Theme: Black/Orange</option>
                <option value="blue" data-translate-key="themeBlue">Theme: Blue</option>
            </select>
            <button id="lang-toggle" onclick="toggleLanguage()" title="Change Language">EN</button>
        </div>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
             <div class="logo-container">
                 <p class="welcome-text" data-translate-key="welcome">Welcome</p>
                 <img src="https://img.freepik.com/premium-vector/pd-logo_590037-76.jpg" alt="Pharmacy Distributor Logo" class="logo">
                 <p class="distributor-text" data-translate-key="distributorTag">PHARMACY DISTRIBUTER</p>
             </div>
         </div>

        <!-- Login Screen -->
        <div id="login-screen" class="screen">
           <div class="header">
               <!-- No back button here -->
               <div class="header-content-wrapper"> <!-- Static Wrapper -->
                   <h1 data-translate-key="loginTitle">Log In</h1>
                   <!-- Controls injected here -->
               </div>
           </div>
           <div class="form-container"> <form id="loginForm" onsubmit="handleLogin(event)"> <div class="input-group"> <label for="login-email" data-translate-key="emailLabel">Email</label> <input type="email" id="login-email" name="email" required> </div> <div class="input-group"> <label for="login-password" data-translate-key="passwordLabel">Password</label> <input type="password" id="login-password" name="password" required> </div> <div class="link-text"> <span data-translate-key="noAccount">you don't have account?</span> <a href="#" onclick="showScreen('signup-screen-1'); return false;" data-translate-key="signupLink">Signup</a> </div> <button type="submit" class="next-button" data-translate-key="nextButton">Next</button> </form> </div>
            <div class="footer-logo"><span>PD</span></div>
        </div>

        <!-- Signup Screen 1 -->
        <div id="signup-screen-1" class="screen">
            <div class="header">
               <a href="#" class="back-button" onclick="showScreen('login-screen'); return false;"><</a>
               <div class="header-content-wrapper"> <!-- Static Wrapper -->
                   <h1 data-translate-key="signupTitle">Sign up</h1>
                   <!-- Controls injected here -->
               </div>
           </div>
            <div class="form-container"> <form id="signupForm1" onsubmit="handleSignupStep1(event)"> <div class="input-group"> <label for="signup-name" data-translate-key="nameLabel">Name</label> <input type="text" id="signup-name" name="name" required> </div> <div class="input-group"> <label for="signup-email" data-translate-key="emailLabel">Email</label> <input type="email" id="signup-email" name="email" required> </div> <div class="input-group"> <label for="signup-password" data-translate-key="passwordLabel">Password</label> <input type="password" id="signup-password" name="password" required> </div> <label class="form-label" data-translate-key="genderLabel">Gender</label> <div class="gender-options"> <span class="gender-box radio-option"> <input type="radio" id="male" name="gender" value="male" required> <label for="male" data-translate-key="genderMale">Male</label> </span> <span class="gender-box radio-option"> <input type="radio" id="female" name="gender" value="female"> <label for="female" data-translate-key="genderFemale">Female</label> </span> </div> <button type="submit" class="next-button" data-translate-key="nextButton">Next</button> </form> </div>
             <div class="footer-logo"><span>PD</span></div>
        </div>

       <!-- Signup Screen 2 -->
       <div id="signup-screen-2" class="screen">
            <div class="header">
               <a href="#" class="back-button" onclick="showScreen('signup-screen-1'); return false;"><</a>
               <div class="header-content-wrapper"> <!-- Static Wrapper -->
                   <h1 data-translate-key="signupTitle">Sign up</h1>
                   <!-- Controls injected here -->
               </div>
            </div>
           <div class="form-container"> <form id="signupForm2" onsubmit="handleSignupStep2(event)"> <div class="input-group"> <label for="signup-age" data-translate-key="ageLabel">Age</label> <input type="number" id="signup-age" name="age" required min="1"> </div> <div class="input-group"> <label for="signup-occupation-select" data-translate-key="occupationLabel">Occupation</label> <select id="signup-occupation-select" name="occupation-select" required> <option value="" disabled selected data-translate-key="selectOccupation">Select Occupation</option> <option value="factory" data-translate-key="occupationFactory">Factory</option> <option value="distributor" data-translate-key="occupationDistributor">Distributor</option> <option value="other" data-translate-key="occupationOther">Other</option> </select> </div> <label class="form-label" data-translate-key="typeLabel">Type</label> <div class="occupation-options radio-option"> <input type="radio" id="factory-radio" name="occupation-type" value="factory" required> <label for="factory-radio" data-translate-key="occupationFactory">Factory</label> </div> <div class="occupation-options radio-option"> <input type="radio" id="distributor-radio" name="occupation-type" value="distributor"> <label for="distributor-radio" data-translate-key="occupationDistributor">Distributor</label> </div> <button type="submit" class="next-button" data-translate-key="nextButton">Next</button> </form> </div>
            <div class="footer-logo"><span>PD</span></div>
        </div>

       <!-- Home Screen -->
       <div id="home-screen" class="screen">
           <div class="header">
               <!-- No back button -->
               <div class="header-content-wrapper"> <!-- Static Wrapper -->
                   <h1 data-translate-key="homeTitle">Home</h1>
                   <!-- Controls injected here -->
               </div>
           </div>
           <div class="tabs"> <span class="tab active" onclick="filterProducts('pharma')" data-translate-key="tabPharma">Pharma</span> <span class="tab" onclick="filterProducts('cosmetics')" data-translate-key="tabCosmetics">Cosmetics</span> </div>
           <div class="content"> <div class="product-grid" id="product-grid-container"> <!-- Products Loaded Here --> </div> </div>
            <div class="footer-logo"><span>PD</span></div>
       </div>

       <!-- Payment Screen -->
       <div id="payment-screen" class="screen">
           <div class="header">
                <a href="#" class="back-button" onclick="showScreen('home-screen'); return false;"><</a>
                <div class="header-content-wrapper"> <!-- Static Wrapper -->
                    <h1 data-translate-key="paymentTitle">Payment</h1>
                    <!-- Controls injected here -->
                </div>
           </div>
           <div class="content"> <img id="payment-product-image" src="" alt="Product Image"> <div id="payment-product-price">Price: 0 L.E</div> <button class="order-button" onclick="showScreen('card-details-screen')" data-translate-key="orderButton">Order</button> </div>
            <div class="footer-logo"><span>PD</span></div>
       </div>

       <!-- Card Details Screen -->
       <div id="card-details-screen" class="screen">
           <div class="header">
                <a href="#" class="back-button" onclick="showScreen('payment-screen'); return false;"><</a>
                <div class="header-content-wrapper"> <!-- Static Wrapper -->
                    <h1 data-translate-key="paymentTitle">Payment</h1>
                    <!-- Controls injected here -->
                </div>
           </div>
           <div class="content"> <form id="card-form" onsubmit="submitPayment(event)"> <label for="card-id" data-translate-key="cardIdLabel">Card ID</label> <input type="text" id="card-id" name="card-id" required> <label for="card-password" data-translate-key="passwordLabel">Password</label> <input type="password" id="card-password" name="password" required> <label class="form-label" data-translate-key="paymentMethodLabel">Payment Method</label> <div class="payment-options"> <div class="radio-option"> <input type="radio" id="pay-pal" name="payment-type" value="pay-pal" checked> <label for="pay-pal" class="radio-label" data-translate-key="payPalLabel">PayPal</label> </div> <div class="radio-option"> <input type="radio" id="visa" name="payment-type" value="visa"> <label for="visa" class="radio-label" data-translate-key="visaLabel">Visa</label> </div> </div> <button type="submit" class="submit-button" data-translate-key="submitButton">Submit</button> </form> </div>
           <div class="footer-logo"><span>PD</span></div>
       </div>

        <!-- Payment Done Screen -->
        <div id="payment-done-screen" class="screen">
            <div class="header">
                <!-- No back button -->
                <div class="header-content-wrapper"> <!-- Static Wrapper -->
                    <h1 data-translate-key="paymentTitle">Payment</h1>
                    <!-- Controls injected here -->
                </div>
            </div>
            <div class="content"> <div class="checkmark">✓</div> <div class="done-message" data-translate-key="paymentDone">Done</div> <button class="submit-button" onclick="goHomeAfterPayment()" data-translate-key="okButton">OK</button> </div>
             <div class="footer-logo"><span>PD</span></div>
        </div>

    </div> <!-- End app-container -->


    <script>
        const products = [ { id: 1, name: "Product 1", price: 265, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZfeN678zStlGGHoN9fg353KbB0nIedhDpiQ&s" }, { id: 2, name: "Product 2", price: 240, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRhqr50M1oYS3zQ4t1a04L3hQNtK0tuzPaVw&s" }, { id: 3, name: "Product 3", price: 245, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRdrliTxBSwFxoVtGdsSYpQnBd0jauK2HlCMg&s" }, { id: 4, name: "Product 4", price: 145, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRjiW2PVyFRYIKZUPT40vFHQam4p80wZexJ4w&s" }, { id: 5, name: "Product 5", price: 135, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPFDrH9l8w_aM2V_iwAMTmeg4VgPXUJpZefw&s" }, { id: 6, name: "Product 6", price: 120, category: "pharma", image: "https://cdn.supercommerce.io/tarshouby/uploads/126352--1729757062.jpg" }, { id: 7, name: "Product 7", price: 250, category: "pharma", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTrM1_Ca5Z6WZq_nyzIpxYg0Db0G0mNii_QNQ&s" }, { id: 8, name: "Product 8", price: 260, category: "pharma", image: "https://cdn.salla.sa/DpzGv/VsgOzze8Qt2ZfambXlPyYc9sQ9j8jw8y6o72ahFi.jpg" }, { id: 9, name: "Cosmetic 1", price: 150, category: "cosmetics", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRkEhsrGg76XVeYFf2sb3AsDEaDiXHpGUScEw&s" }, { id: 10, name: "Cosmetic 2", price: 200, category: "cosmetics", image: "https://media.getshopx.shop/images/evacosmetics/products/YpbmHEKF1qrvVYcOFk6sSBhxhqRgNuwHHiJgNcWR.webp" }, { id: 11, name: "Cosmetic 3", price: 150, category: "cosmetics", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGJrCkRcJzOrNWfqukSVGjZWIdRMPDJlu_lw&s" }, { id: 12, name: "Cosmetic 4", price: 180, category: "cosmetics", image: "https://media.getshopx.shop/images/evacosmetics/products/n9wlaDk4mqIWKgvYrnxrXrDptRDQloaNeXSaK5aU.webp" }, { id: 13, name: "Cosmetic 5", price: 185, category: "cosmetics", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRSAaG0Kh5X1lh5_W7tkjOhcqdaYuTczp77UQ&s" }, { id: 14, name: "Cosmetic 6", price: 175, category: "cosmetics", image: "https://media.zid.store/2627a068-77ba-4b31-901f-83569cf7e3ae/7589528e-86f6-44cb-8ef7-f0c634950fc0.jpg" }, { id: 15, name: "Cosmetic 7", price: 160, category: "cosmetics", image: "https://cdn.chefaa.com/filters:format(webp)/public/uploads/products/1620206405aloe-eva-argan-hair-mask-185gm-chefaajpg" }, { id: 16, name: "Cosmetic 8", price: 175, category: "cosmetics", image: "https://gomlaplus.com/storage/app/public/product/2024-04-28-662e4914e178a.webp" } ];
        const translations = { en: { appTitle: "Pharmacy Distributor App", welcome: "Welcome", distributorTag: "PHARMACY DISTRIBUTER", loginTitle: "Log In", emailLabel: "Email", passwordLabel: "Password", noAccount: "you don't have account?", signupLink: "Signup", nextButton: "Next", signupTitle: "Sign up", nameLabel: "Name", genderLabel: "Gender", genderMale: "Male", genderFemale: "Female", ageLabel: "Age", occupationLabel: "Occupation", selectOccupation: "Select Occupation", occupationFactory: "Factory", occupationDistributor: "Distributor", occupationOther: "Other", typeLabel: "Type", homeTitle: "Home", tabPharma: "Pharma", tabCosmetics: "Cosmetics", paymentTitle: "Payment", orderButton: "Order", cardIdLabel: "Card ID", paymentMethodLabel: "Payment Method", payPalLabel: "PayPal", visaLabel: "Visa", submitButton: "Submit", paymentDone: "Done", okButton: "OK", priceLabel: "Price", currency: "L.E", noProducts: "No products found.", themeDefault: "Theme: Default", themeRed: "Theme: Red", themeBW: "Theme: B&W", themeBlack: "Theme: Black", themeBlackRed: "Theme: Black/Red", themeBlackOrange: "Theme: Black/Orange", themeBlue: "Theme: Blue", langButtonEN: "AR", langButtonAR: "EN" }, ar: { appTitle: "تطبيق موزع أدوية", welcome: "مرحباً", distributorTag: "موزع أدوية", loginTitle: "تسجيل الدخول", emailLabel: "البريد الإلكتروني", passwordLabel: "كلمة المرور", noAccount: "ليس لديك حساب؟", signupLink: "اشتراك", nextButton: "التالي", signupTitle: "اشتراك", nameLabel: "الاسم", genderLabel: "الجنس", genderMale: "ذكر", genderFemale: "أنثى", ageLabel: "العمر", occupationLabel: "المهنة", selectOccupation: "اختر المهنة", occupationFactory: "مصنع", occupationDistributor: "موزع", occupationOther: "أخرى", typeLabel: "النوع", homeTitle: "الرئيسية", tabPharma: "أدوية", tabCosmetics: "تجميل", paymentTitle: "الدفع", orderButton: "اطلب", cardIdLabel: "معرف البطاقة", paymentMethodLabel: "طريقة الدفع", payPalLabel: "باي بال", visaLabel: "فيزا", submitButton: "إرسال", paymentDone: "تم", okButton: "موافق", priceLabel: "السعر", currency: "ج.م", noProducts: "لم يتم العثور على منتجات.", themeDefault: "السمة: افتراضي", themeRed: "السمة: أحمر", themeBW: "السمة: أبيض وأسود", themeBlack: "السمة: أسود", themeBlackRed: "السمة: أسود/أحمر", themeBlackOrange: "السمة: أسود/برتقالي", themeBlue: "السمة: أزرق", langButtonEN: "AR", langButtonAR: "EN" } };
        let currentProduct = null; let signupData = {}; let currentLang = 'en'; let currentTheme = 'default';
        const gridContainer = document.getElementById('product-grid-container'); const tabs = document.querySelectorAll('#home-screen .tabs .tab'); const headerControlsTemplate = document.getElementById('header-controls-template').innerHTML; const appContainer = document.querySelector('.app-container');

        function injectHeaderControls() {
            const headers = document.querySelectorAll('.screen .header');
            headers.forEach(header => {
                let wrapper = header.querySelector('.header-content-wrapper');
                if (!wrapper) { console.error("Header structure error: '.header-content-wrapper' not found in:", header); return; }
                let controlsContainer = wrapper.querySelector('.header-controls');
                if (!controlsContainer) { controlsContainer = document.createElement('div'); controlsContainer.classList.add('header-controls'); controlsContainer.innerHTML = headerControlsTemplate; wrapper.appendChild(controlsContainer); }
                const selector = controlsContainer.querySelector('#theme-selector'); if (selector) selector.value = currentTheme;
                const langButton = controlsContainer.querySelector('#lang-toggle'); if(langButton) langButton.textContent = translations[currentLang][`langButton${currentLang.toUpperCase()}`];
            });
        }

        function setLanguage(lang) {
            currentLang = lang; const direction = lang === 'ar' ? 'rtl' : 'ltr'; document.documentElement.lang = lang; document.documentElement.dir = direction; localStorage.setItem('appLanguage', lang);
            document.querySelectorAll('[data-translate-key]').forEach(el => { const key = el.dataset.translateKey; if (translations[lang] && translations[lang][key]) { if (el.tagName === 'INPUT' && el.placeholder !== undefined) {} else if (el.tagName === 'OPTION' && el.value === "") { el.textContent = translations[lang][key]; } else { el.textContent = translations[lang][key]; } } });
            const langButtons = document.querySelectorAll('#lang-toggle'); langButtons.forEach(button => { button.textContent = translations[lang][`langButton${lang.toUpperCase()}`]; });
            if (currentProduct) { updatePaymentScreenPrice(); } if (document.getElementById('home-screen').classList.contains('active')) { const activeCategory = document.querySelector('#home-screen .tab.active')?.getAttribute('onclick')?.match(/filterProducts\('([^']+)'\)/)?.[1] || 'pharma'; filterProducts(activeCategory); } updateSelectArrowColor();
        }

        function toggleLanguage() { const newLang = currentLang === 'en' ? 'ar' : 'en'; setLanguage(newLang); }

        function setTheme(theme) {
            currentTheme = theme; document.body.dataset.theme = theme; localStorage.setItem('appTheme', theme);
            const selectors = document.querySelectorAll('#theme-selector'); selectors.forEach(sel => sel.value = theme);
            setTimeout(() => { const contentBg = getComputedStyle(document.documentElement).getPropertyValue('--content-bg').trim(); document.documentElement.style.setProperty('--header-curve-bg', contentBg); updateSelectArrowColor(); }, 50);
        }

        function updateSelectArrowColor() {
            const isRTL = document.documentElement.dir === 'rtl'; const arrowColor = getComputedStyle(document.documentElement).getPropertyValue('--text-muted').trim(); const encodedColor = encodeURIComponent(arrowColor); const svgUrl = `url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%27292.4%27%20height%3D%27292.4%27%3E%3Cpath%20fill%3D%27${encodedColor}%27%20d%3D%27M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.4-5.4-12.8z%27%2F%3E%3C%2Fsvg%3E")`;
            document.querySelectorAll('.form-container select').forEach(select => { select.style.backgroundImage = svgUrl; });
        }

        function showScreen(screenId) { const screens = document.querySelectorAll('.app-container .screen'); screens.forEach(screen => screen.classList.remove('active')); const activeScreen = document.getElementById(screenId); if (activeScreen) { activeScreen.classList.add('active'); appContainer.scrollTop = 0; injectHeaderControls(); setLanguage(currentLang); } }
        function renderProducts(items) { gridContainer.innerHTML = ''; if (!items || items.length === 0) { gridContainer.innerHTML = `<p data-translate-key="noProducts" style="grid-column: 1 / -1; text-align: center;">${translations[currentLang].noProducts}</p>`; return; } items.forEach(product => { const itemDiv = document.createElement('div'); itemDiv.classList.add('product-item'); itemDiv.setAttribute('onclick', `viewProduct(${product.id})`); itemDiv.innerHTML = `<img src="${product.image}" loading="lazy" alt="${product.name || 'Product'}">`; gridContainer.appendChild(itemDiv); }); }
        function filterProducts(category) { tabs.forEach(tab => { tab.classList.remove('active'); if (tab.getAttribute('onclick')?.includes(`filterProducts('${category}')`)) { tab.classList.add('active'); } }); const filtered = products.filter(p => p.category === category); renderProducts(filtered); }
        function updatePaymentScreenPrice() { if (currentProduct) { const priceText = translations[currentLang].priceLabel || "Price"; const currency = translations[currentLang].currency || "L.E"; document.getElementById('payment-product-price').textContent = `${priceText}: ${currentProduct.price} ${currency}`; } }
        function viewProduct(productId) { currentProduct = products.find(p => p.id === productId); if (currentProduct) { document.getElementById('payment-product-image').src = currentProduct.image; document.getElementById('payment-product-image').alt = currentProduct.name || "Product"; updatePaymentScreenPrice(); showScreen('payment-screen'); } }
        function submitPayment(event) { event.preventDefault(); const cardId = document.getElementById('card-id').value; const password = document.getElementById('card-password').value; if (!cardId || !password) { alert(currentLang === 'ar' ? 'يرجى ملء معرف البطاقة وكلمة المرور.' : 'Please fill in Card ID and Password.'); return; } console.log('Payment submitted (simulated)'); document.getElementById('card-form').reset(); showScreen('payment-done-screen'); }
        function goHomeAfterPayment() { const activeCategoryElement = document.querySelector('#home-screen .tab.active'); const activeCategory = activeCategoryElement?.getAttribute('onclick')?.match(/filterProducts\('([^']+)'\)/)?.[1] || 'pharma'; filterProducts(activeCategory); showScreen('home-screen'); }
        function handleLogin(event) { event.preventDefault(); console.log('Login attempt (simulated)'); document.getElementById('loginForm').reset(); showScreen('home-screen'); }
        function handleSignupStep1(event) { event.preventDefault(); signupData.name = document.getElementById('signup-name').value; signupData.email = document.getElementById('signup-email').value; signupData.password = document.getElementById('signup-password').value; signupData.gender = document.querySelector('input[name="gender"]:checked')?.value; if(signupData.name && signupData.email && signupData.password && signupData.gender){ showScreen('signup-screen-2'); } else { alert(currentLang === 'ar' ? 'يرجى ملء جميع الحقول في الخطوة 1.' : 'Please fill all fields in Step 1.'); } }
        function handleSignupStep2(event) { event.preventDefault(); signupData.age = document.getElementById('signup-age').value; signupData.occupationSelect = document.getElementById('signup-occupation-select').value; signupData.occupationType = document.querySelector('input[name="occupation-type"]:checked')?.value; if(signupData.age && signupData.occupationSelect && signupData.occupationType){ console.log("Signup Complete:", signupData); document.getElementById('signupForm1').reset(); document.getElementById('signupForm2').reset(); signupData = {}; showScreen('home-screen'); } else { alert(currentLang === 'ar' ? 'يرجى ملء جميع الحقول في الخطوة 2.' : 'Please fill all fields in Step 2.'); } }

        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('appTheme') || 'default'; const savedLang = localStorage.getItem('appLanguage') || 'en';
            setTheme(savedTheme); setLanguage(savedLang);
            setTimeout(() => { if (document.getElementById('welcome-screen').classList.contains('active')) { showScreen('login-screen'); } }, 2000);
            filterProducts('pharma');
            const initialContentBg = getComputedStyle(document.documentElement).getPropertyValue('--content-bg').trim(); document.documentElement.style.setProperty('--header-curve-bg', initialContentBg); updateSelectArrowColor();
        });
    </script>

</body>
</html>